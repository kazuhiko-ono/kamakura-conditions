# CLAUDE.md - 鎌倉コンディションアプリ

## これは何か

鎌倉 七里ヶ浜・坂ノ下エリアの風・気温・波のリアルタイム状況を表示するWebアプリ。
海辺でスマホから確認する。誰でもアクセスできる公開サイト。

## 技術方針

- HTML + CSS + JavaScript の単一ファイル構成（フレームワーク不要、ビルド不要）
- データソース: Open-Meteo API（無料・APIキー不要）
- テスト: Playwright でUI自動検証
- ホスティング: Cloudflare Pages（GitHub連携で自動デプロイ）
- 開発: Claude Code + Context7 MCP

## 対象エリア

- 緯度: 35.3025 / 経度: 139.5232（七里ヶ浜〜坂ノ下の海岸）

## API

- Weather: `https://api.open-meteo.com/v1/forecast`
- Marine: `https://marine-api.open-meteo.com/v1/marine`
- 実装前に Context7 で最新の仕様を必ず確認すること

## 開発ルール

1. フェーズごとに小さく作り、動作確認してから次へ進む
2. 各フェーズで Playwright テスト（`tests/phaseN.spec.js`）を書いて通す
3. 過去フェーズのテストが壊れていないことを確認してからコミットする
4. コミットメッセージ: `Phase N: 〇〇〇`（日本語）
5. 外部ライブラリは CDN のみ（npm はテスト専用）
6. モバイルファースト（最小幅 320px）
7. エラーハンドリングは毎フェーズ必ず含める

## Playwright 設定

- ローカルサーバ: `npx serve -l 8080 -s .`
- ビューポート: 375×812（iPhone SE 相当）
- API モックは使わない（実際の Open-Meteo にアクセス）
- エラー系テストは `route.abort` で模擬

## フェーズ計画

### Phase 1: 風データ取得
Weather API から現在の風速・風向・気温を取得して表示する。装飾なし。
- 完了条件: データ表示される / エラー表示される / 再取得できる

### Phase 2: 波データ追加
Marine API を追加し、波高・周期・うねりを表示する。
- 完了条件: 2つの API を並列取得 / 波データ表示 / 片方失敗時にもう片方は表示

### Phase 3: 風向コンパス & 波ビジュアル
風向を矢印コンパスで、波高をバーで視覚化する。
- 完了条件: 矢印が風向に連動 / バーが波高に連動

### Phase 4: コンディション判定
風速×波高からアクティビティ適性を自動判定する。
- ウィングフォイル / サーフィン / SUP の3種
- 完了条件: 判定バッジ表示 / good・ok・caution の色分け

### Phase 5: 時間別予報
今後24時間の風・気温・波を横スクロールで表示する。
- 完了条件: 20個以上の時間枠 / 現在時刻ハイライト / スクロール可能

### Phase 6: 3日間予報
日ごとの概況（天気・気温・風速・降水確率）を表示する。
- 完了条件: 3日分表示 / 「今日」「明日」表記

### Phase 7: デザイン仕上げ
ダークテーマ、カード型レイアウト、アニメーション、PWA対応。
- 完了条件: モバイルで横はみ出しなし / ダークテーマ適用 / 更新時刻表示

### Phase 8: デプロイ
GitHub push → Cloudflare Pages で公開。
- 完了条件: pages.dev URL で誰でもアクセス・表示できる

## 将来の拡張候補

- ライブカメラ / 潮汐 / 複数ポイント切替 / プッシュ通知
